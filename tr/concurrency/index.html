


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Go Tutorial">
      
      
        <link rel="canonical" href="https://mgurdal.github.io/go-tutorial/tr/concurrency/">
      
      
        <meta name="author" content="Mehmet GÃ¼rdal">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.0">
    
    
      
        <title>Concurrency - Go Tutorial</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.89dc9fe3.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/css/extra.css">
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-163254669-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#concurrency" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://mgurdal.github.io/go-tutorial" title="Go Tutorial" class="md-header-nav__button md-logo" aria-label="Go Tutorial">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Go Tutorial
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Concurrency
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://mgurdal.github.io/go-tutorial" title="Go Tutorial" class="md-nav__button md-logo" aria-label="Go Tutorial">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    Go Tutorial
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../data-structures/" title="Data Structures" class="md-nav__link">
      Data Structures
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../concurrency/" title="Concurrency" class="md-nav__link">
      Concurrency
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#goroutines" class="md-nav__link">
    Goroutines
  </a>
  
    <nav class="md-nav" aria-label="Goroutines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#waitgroup" class="md-nav__link">
    waitGroup
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kanalllar-channels" class="md-nav__link">
    Kanalllar (Channels)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mutex" class="md-nav__link">
    Mutex
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select" class="md-nav__link">
    Select
  </a>
  
    <nav class="md-nav" aria-label="Select">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zaman-asm" class="md-nav__link">
    Zaman AÅŸÄ±mÄ±
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    Context
  </a>
  
    <nav class="md-nav" aria-label="Context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uygulans" class="md-nav__link">
    UygulanÄ±ÅŸ
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ornek-uygulama" class="md-nav__link">
    Ã–rnek Uygulama
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="concurrency">Concurrency<a class="headerlink" href="#concurrency" title="Permanent link">&para;</a></h1>
<p><a href="/go-tutorial/concurrency">English</a> | <a href="/go-tutorial/tr/concurrency">TÃ¼rkÃ§e</a></p>
<p>Bilgisayar biliminde concurrency(eÅŸzamanlÄ±lÄ±k), bir programdaki iÅŸ birimlerinin veya algoritmalarÄ±n sonucu etkilemeyecek ÅŸekilde <strong>sÄ±rasÄ±z</strong> bir biÃ§imde Ã§alÄ±ÅŸtÄ±rÄ±labilmesidir.</p>
<p>Ä°ÅŸ parÃ§alarÄ±nÄ± birbirinden baÄŸÄ±msÄ±z Ã§alÄ±ÅŸtÄ±rabilmemiz, sÃ¼reÃ§leri farklÄ± Ã§ekirdeklerde yÃ¼rÃ¼terek, iÅŸlemciyi maksimum verimde kullanmamÄ±zÄ± saÄŸlar.</p>
<p>GO dilinde concurrency goroutineler ile saÄŸlanÄ±r.</p>
<h2 id="goroutines">Goroutines<a class="headerlink" href="#goroutines" title="Permanent link">&para;</a></h2>
<p>GO routineleri bir kuyrukta Ã§alÄ±ÅŸtÄ±rÄ±lmayÄ± bekleyen boyutlarÄ± kÃ¼Ã§Ã¼k threadler olarak dÃ¼ÅŸÃ¼nÃ¼lebilir. Bir fonksiyonu goroutine olarak Ã§alÄ±ÅŸtÄ±rmak iÃ§in Ã§aÄŸÄ±rÄ±rken baÅŸÄ±na <code>go</code> yazmamÄ±z yeterli.</p>
<p>AÅŸaÄŸÄ±daki uygulamada Work fonksiyonu her Ã§aÄŸrÄ±ldÄ±ÄŸÄ±nda, Ã§alÄ±ÅŸmasÄ± bitene kadar uygulamayÄ± blokluyor.</p>
<p><img alt="routine" src="../../assets/img/routine.gif" /></p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">Work</span><span class="p">(</span><span class="nx">msg</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
    <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;work work work work work work...&quot;</span><span class="p">)</span>
    <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;zxcasfv&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<p>Bloklayan kÄ±sÄ±mlarÄ± goroutine olarak Ã§alÄ±ÅŸtÄ±ralÄ±m.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;work work work work work work...&quot;</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;zxcasfv&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<p><img alt="goroutine" src="../../assets/img/goroutine_unfinished.gif" /></p>
<p>ProgramÄ± Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±zda ekrana hiÃ§bir ÅŸey yazdÄ±rmadan sonlanacak. <code>main</code> fonksiyonu, <code>Work</code> fonksiyonu henÃ¼z ekrana bir ÅŸeyler yazacak kadar Ã§alÄ±ÅŸmadan, bitiyor ve program kapanÄ±yor. Program bitmeden Ã¶nce biraz bekleterek <code>Work</code> fonksiyonunun Ã§Ä±ktÄ±sÄ±nÄ± alabiliriz.</p>
<p><img alt="goroutine_sleep" src="../../assets/img/goroutine_sleep.gif" /></p>
<div class="codehilite"><pre><span></span><code><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nx">Work</span><span class="p">(</span><span class="nx">msg</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
    <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;work work work work work work...&quot;</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;zxcasfv&quot;</span><span class="p">)</span>
    <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<h3 id="waitgroup">waitGroup<a class="headerlink" href="#waitgroup" title="Permanent link">&para;</a></h3>
<p>UygulamanÄ±n bir anÄ±nda bazÄ± goroutinelerin bitmesini beklememiz gerekebilir.</p>
<p>WaitGroup ile kaÃ§ tane gorouitine bekleyeceÄŸimizi Ã¶ncesindem belirtip bu goroutinelerin iÅŸlerini bitirmelerini bekleyebiliriz. Goroutinelerin burada tek yapmasÄ± gereken, iÅŸi bittiÄŸinde WaitGroup'un <code>Done()</code> methodunu Ã§alÄ±ÅŸtÄ±rmasÄ±.</p>
<p><img alt="waitgroup" src="../../assets/img/waitgroup.gif" /></p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">Work</span><span class="p">(</span><span class="nx">msg</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">wg</span> <span class="o">*</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Done</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">nWorkers</span> <span class="o">:=</span> <span class="mi">5</span>
    <span class="nx">wg</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">{}</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Add</span><span class="p">(</span><span class="nx">nWorkers</span><span class="p">)</span>

    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">nWorkers</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;work&quot;</span><span class="p">,</span> <span class="nx">wg</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">wg</span><span class="p">.</span><span class="nx">Wait</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="kanalllar-channels">Kanalllar (Channels)<a class="headerlink" href="#kanalllar-channels" title="Permanent link">&para;</a></h2>
<p>Kanallar goroutinelerin birbirleri ile haberleÅŸmesini saÄŸlar.</p>
<p>YukarÄ±daki Ã¶rnekte <code>go</code> ile Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±z fonksiyonlardan dÃ¶nÃ¼ÅŸ deÄŸeri alamÄ±yoruz. KanallarÄ± kullanarak bir goroutiniin, ana fonksiyonla veya baÅŸka bir goroutine ile haberleÅŸmesini saÄŸlayabiliriz.</p>
<p>Kanallar <code>make(chan veritipi, buffer)</code> ÅŸeklinde oluÅŸturulabilir.</p>
<p><img alt="channel_simple" src="../../assets/img/channel_simple.gif" /></p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">Work</span><span class="p">(</span><span class="nx">msg</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">ch</span> <span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nx">ch</span> <span class="o">&lt;-</span> <span class="nx">msg</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">channel</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;work-1&quot;</span><span class="p">,</span> <span class="nx">channel</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="s">&quot;work-2&quot;</span><span class="p">,</span> <span class="nx">channel</span><span class="p">)</span>

    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="nx">msg</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">channel</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<h2 id="mutex">Mutex<a class="headerlink" href="#mutex" title="Permanent link">&para;</a></h2>
<p>Mutex, goroutineler tarafÄ±ndan ortak kullanÄ±lan bir deÄŸiÅŸkenin deÄŸerininin, <strong>race-condition</strong> oluÅŸmadan deÄŸiÅŸtirilebilmesini saÄŸlayan yapÄ±dÄ±r.</p>
<div class="admonition quote">
<p class="admonition-title">Wikipedia TanÄ±mÄ±</p>
<p>In computer science, mutual exclusion is a property of concurrency control, which is instituted for the purpose of preventing race conditions. It is the requirement that one thread of execution never enters its critical section at the same time that another concurrent thread of execution enters its own critical section, which refers to an interval of time during which a thread of execution accesses a shared resource, such as shared memory.</p>
</div>
<p>AÅŸaÄŸÄ±daki Ã¶rnekte, kullanÄ±cÄ± tÄ±klamalarÄ±nÄ± saymak iÃ§in <code>Counter</code> yapÄ±sÄ±nÄ± kullanÄ±yoruz.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">type</span>  <span class="nx">Counter</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Value</span> <span class="kt">int</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Counter</span><span class="p">)</span> <span class="nx">Inc</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">Value</span><span class="o">++</span>
<span class="p">}</span>


<span class="kd">func</span> <span class="nx">Click</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Counter</span><span class="p">,</span> <span class="nx">wg</span> <span class="o">*</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">Inc</span><span class="p">()</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Done</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">nUsers</span> <span class="o">:=</span> <span class="mi">500</span>
    <span class="nx">wg</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">{}</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Add</span><span class="p">(</span><span class="nx">nUsers</span><span class="p">)</span>

    <span class="nx">counter</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Counter</span><span class="p">{}</span>

    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">nUsers</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="k">go</span> <span class="nx">Click</span><span class="p">(</span><span class="nx">counter</span><span class="p">,</span> <span class="nx">wg</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">wg</span><span class="p">.</span><span class="nx">Wait</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">counter</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>

<span class="p">}</span>
</code></pre></div>


<p>Ä°lk bakÄ±ÅŸta programda yanlÄ±ÅŸ bir ÅŸey gÃ¶zÃ¼kmÃ¼yor. Fakat programÄ± <strong>--race</strong> parametresi ile derleyip Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ±mÄ±zda; bize programda <strong>race-condition</strong> olduÄŸunu sÃ¶ylÃ¼yor.</p>
<p><img alt="race" src="../../assets/img/race.png" /></p>
<p>Bu program Ã§ok Ã§ekirdekli bir bilgisayarda Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda, <code>Click</code> fonksiyonu farklÄ± Ã§ekirdeklerde aynÄ± anda Ã§alÄ±ÅŸtÄ±rÄ±labiliyor. Bu nedenle program yeni <code>c.Value</code> deÄŸerini yanlÄ±ÅŸ gÃ¼ncelliyor.</p>
<p><img alt="race" src="../../assets/img/race.gif" /></p>
<p>Bu hatayÄ± <code>main</code> fonksiyonu iÃ§inde bir Mutex oluÅŸturup; <code>mx.Lock</code> ve <code>mx.Unlock</code> metodlarÄ±nÄ± <code>Value</code> deÄŸerini deÄŸiÅŸtirdiÄŸimiz yerde kullanarak giderebiliriz.</p>
<p><img alt="race" src="../../assets/img/mutex.gif" /></p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">Click</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Counter</span><span class="p">,</span> <span class="nx">wg</span> <span class="o">*</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">,</span> <span class="nx">mx</span> <span class="o">*</span><span class="nx">sync</span><span class="p">.</span><span class="nx">Mutex</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">mx</span><span class="p">.</span><span class="nx">Lock</span><span class="p">()</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">Inc</span><span class="p">()</span>
    <span class="nx">mx</span><span class="p">.</span><span class="nx">Unlock</span><span class="p">()</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Done</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">nUsers</span> <span class="o">:=</span> <span class="mi">500</span>
    <span class="nx">wg</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">{}</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Add</span><span class="p">(</span><span class="nx">nUsers</span><span class="p">)</span>

    <span class="nx">mx</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">sync</span><span class="p">.</span><span class="nx">Mutex</span><span class="p">{}</span>
    <span class="nx">counter</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Counter</span><span class="p">{}</span>

    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">nUsers</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="k">go</span> <span class="nx">Click</span><span class="p">(</span><span class="nx">counter</span><span class="p">,</span> <span class="nx">wg</span><span class="p">,</span> <span class="nx">mx</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">wg</span><span class="p">.</span><span class="nx">Wait</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">counter</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>

<span class="p">}</span>
</code></pre></div>


<p>Mutexlerin struct iÃ§erisinde tanÄ±mlanmasÄ± da yaygÄ±n bir kullanÄ±mdÄ±r. </p>
<p>Bu Ã¶rnekte, Mutexi, Counter iÃ§inde tanÄ±mlayÄ±p <code>c.Lock</code> ve <code>c.Unlock</code> metodlarÄ± ile
yine problemi Ã§Ã¶zebilirdik.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">type</span>  <span class="nx">Counter</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Value</span> <span class="kt">int</span>
    <span class="o">*</span><span class="nx">sync</span><span class="p">.</span><span class="nx">Mutex</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Counter</span><span class="p">)</span> <span class="nx">Inc</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">Value</span><span class="o">++</span>
<span class="p">}</span>


<span class="kd">func</span> <span class="nx">Click</span><span class="p">(</span><span class="nx">c</span> <span class="o">*</span><span class="nx">Counter</span><span class="p">,</span> <span class="nx">wg</span> <span class="o">*</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">Lock</span><span class="p">()</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">Inc</span><span class="p">()</span>
    <span class="nx">c</span><span class="p">.</span><span class="nx">Unlock</span><span class="p">()</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Done</span><span class="p">()</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">nUsers</span> <span class="o">:=</span> <span class="mi">500</span>
    <span class="nx">wg</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">{}</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Add</span><span class="p">(</span><span class="nx">nUsers</span><span class="p">)</span>

    <span class="nx">counter</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Counter</span><span class="p">{</span><span class="nx">Mutex</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">sync</span><span class="p">.</span><span class="nx">Mutex</span><span class="p">{}}</span>

    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">nUsers</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>
        <span class="k">go</span> <span class="nx">Click</span><span class="p">(</span><span class="nx">counter</span><span class="p">,</span> <span class="nx">wg</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">wg</span><span class="p">.</span><span class="nx">Wait</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">counter</span><span class="p">.</span><span class="nx">Value</span><span class="p">)</span>

<span class="p">}</span>
</code></pre></div>


<h2 id="select">Select<a class="headerlink" href="#select" title="Permanent link">&para;</a></h2>
<p>Kanallara veri gÃ¶ndermek veya kanallardan veri beklemek uygulamayÄ± bloklar. </p>
<p>Select aynÄ± anda birkaÃ§ tane kanalÄ± beklememize olanak saÄŸlar. </p>
<p>AÅŸaÄŸÄ±daki Ã¶rnekte 2 goroutine <code>chan1</code> ve <code>chan2</code> kanallarÄ±na sÃ¼rekli veri gÃ¶nderiyor.</p>
<p>Ä°ki kanaldan da gelen tÃ¼m verileri sonsuz bir dÃ¶ngÃ¼ iÃ§indeki select yapÄ±sÄ± ile alabiliriz.
Herhangi bir kanaldan mesaj geldiÄŸinde select o kanalÄ± bekleyen <code>case</code>e girecek ve
iÃ§inde tanÄ±mlanan iÅŸlemler bittikten sonra dÃ¶ngÃ¼, kanal bekleme iÅŸlemini tekrarlayacaktÄ±r.</p>
<p><img alt="select" src="../../assets/img/select.gif" /></p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">Work</span><span class="p">(</span><span class="nx">ch1</span> <span class="kd">chan</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">ch2</span> <span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">// Send data to ch1 every second</span>
    <span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">{</span>
            <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
            <span class="nx">ch1</span> <span class="o">&lt;-</span> <span class="s">&quot;work-1&quot;</span>
        <span class="p">}</span>
    <span class="p">}()</span>

    <span class="c1">// Send data to ch2 every 1.5 seconds</span>
    <span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">{</span>
            <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">)</span>
            <span class="nx">ch2</span> <span class="o">&lt;-</span> <span class="s">&quot;work-2&quot;</span>
        <span class="p">}</span>
    <span class="p">}()</span>

<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">ch1</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>
    <span class="nx">ch2</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>

    <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="nx">ch1</span><span class="p">,</span> <span class="nx">ch2</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">{</span>
        <span class="k">select</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">msg1</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">ch1</span><span class="p">:</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg1</span><span class="p">)</span>
        <span class="k">case</span> <span class="nx">msg2</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">ch2</span><span class="p">:</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg2</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


<h3 id="zaman-asm">Zaman AÅŸÄ±mÄ±<a class="headerlink" href="#zaman-asm" title="Permanent link">&para;</a></h3>
<p>YukarÄ±daki gibi bir program 2 kanaldan da hiÃ§ veri gelmezse kilitlenecektir. 
Sonsuz dÃ¶ngÃ¼ iÃ§erisinde, biteceÄŸine emin olduÄŸumuz baÅŸka bir kanalÄ± daha dinleyerek kÄ±rabiliriz. </p>
<p>Go, bu tÃ¼r durumlar iÃ§in Ã¶nceden tanÄ±mlanmÄ±ÅŸ yapÄ±lara sahiptir. 
Time modÃ¼lÃ¼ndeki <code>time.After</code> fonksiyonu bellirlediÄŸimiz bir sÃ¼reden sonra kanala sinyal gÃ¶nderir.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">ch1</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>
    <span class="nx">ch2</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>

    <span class="k">go</span> <span class="nx">Work</span><span class="p">(</span><span class="nx">ch1</span><span class="p">,</span> <span class="nx">ch2</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">{</span>
        <span class="k">select</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">msg1</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">ch1</span><span class="p">:</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg1</span><span class="p">)</span>
        <span class="k">case</span> <span class="nx">msg2</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">ch2</span><span class="p">:</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">msg2</span><span class="p">)</span>
        <span class="k">case</span> <span class="o">&lt;-</span><span class="nx">time</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">):</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ğŸµ Brave Sir Robin ran away ğŸµ&quot;</span><span class="p">)</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ğŸµ Bravely ran away away    ğŸµ&quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="p">}</span>

    <span class="p">}</span>
</code></pre></div>


<h2 id="context">Context<a class="headerlink" href="#context" title="Permanent link">&para;</a></h2>
<p>"Context, bir iÅŸ iptal edildiÄŸinde veya zaman aÅŸÄ±mÄ±na uÄŸradÄ±ÄŸÄ±nda ilgili birimleri bilgilendirmek iÃ§in kullanÄ±lÄ±r."</p>
<p>Context, en az diÄŸer eÅŸzamanlÄ±lÄ±k yapÄ±larÄ± kadar Ã¶nem arz eder.</p>
<p><code>go Func()</code> ÅŸeklinde bir arkaplan iÅŸi baÅŸtattÄ±ÄŸÄ±mÄ±zda, bize goroutine durumunu kontrol edebileceÄŸimiz bir deÄŸer dÃ¶nÃ¼lmez. </p>
<p>Sonraki durumlarÄ±nÄ± Ã¶nemsemeden bir sÃ¼rÃ¼ goroutine oluÅŸturmak; belirgin
hata vermeden uygulamanÄ±n performansÄ±nÄ± Ã¶nemli Ã¶lÃ§Ã¼de etkileyebilir.</p>
<p>Bazen bir arkaplan gÃ¶revi iÃ§erisinde, Ã§ok fazla kaynaÄŸa ihtiyaÃ§ duyan baÅŸka arkaplan gÃ¶revleri oluÅŸturmamÄ±z gerekir. Bu gÃ¶revleri oluÅŸturan goroutine bitse bile devam etmesi gerekmeyen diÄŸer yavaÅŸ goroutineler Ã§alÄ±ÅŸmaya devam eder ve kaynaklarÄ±mÄ±z boÅŸa harcanÄ±r. </p>
<p>Context bize bu gibi durumlarda yardÄ±mcÄ± olur.</p>
<ul>
<li>Context bir sinyali tÃ¼m arkaplan gÃ¶revlerine yaymamÄ±zÄ± saÄŸlar.</li>
<li>Context hiyerarÅŸileri oluÅŸturabiliriz. Ana context iptal edildiÄŸinde; baÄŸlÄ± tÃ¼m contextler de iptal edilir. </li>
</ul>
<table>
<thead>
<tr>
<th align="center">Context KullanÄ±lmadan</th>
<th align="center">Context KullanÄ±larak</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><img alt="nocontext" src="../../assets/img/nocontext.gif" /></td>
<td align="center"><img alt="context" src="../../assets/img/context.gif" /></td>
</tr>
</tbody>
</table>
<h3 id="uygulans">UygulanÄ±ÅŸ<a class="headerlink" href="#uygulans" title="Permanent link">&para;</a></h3>
<p>GO tÃ¼m bu iÅŸlemleri <code>context</code> paketi iÃ§erisinde sunar.</p>
<p>Paket iÃ§erisinde, tÃ¼m contextleri tanÄ±mlayan, 4 adet metoda sahip <code>context.Context</code> arayÃ¼zÃ¼ bulunur. </p>
<div class="codehilite"><pre><span></span><code><span class="kd">type</span> <span class="nx">Context</span> <span class="kd">interface</span> <span class="p">{</span>
    <span class="nx">Deadline</span><span class="p">()</span> <span class="p">(</span><span class="nx">deadline</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="p">,</span> <span class="nx">ok</span> <span class="kt">bool</span><span class="p">)</span>
    <span class="nx">Done</span><span class="p">()</span> <span class="o">&lt;-</span><span class="kd">chan</span> <span class="kd">struct</span><span class="p">{}</span>
    <span class="nx">Err</span><span class="p">()</span> <span class="kt">error</span>
    <span class="nx">Value</span><span class="p">(</span><span class="nx">key</span> <span class="kd">interface</span><span class="p">{})</span> <span class="kd">interface</span><span class="p">{}</span>
<span class="p">}</span>
</code></pre></div>


<p><code>Deadline()</code> contexte baÄŸlÄ± tÃ¼m iÅŸlerin bitmesi gereken sÃ¼reyi dÃ¶ndÃ¼rÃ¼r. Bu metodu kullanarak; kalan sÃ¼rede bitiremeyeceÄŸimiz bir iÅŸi hiÃ§ baÅŸlatmayabiliriz.</p>
<p><code>Done()</code> tÃ¼m iÅŸler tamamlandÄ±ÄŸÄ±nda veya context iptal edildiÄŸinde sinyal gÃ¶nderen bir kanal dÃ¶ndÃ¼rÃ¼r.</p>
<p><code>Err()</code> contextin neden bittiÄŸini aÃ§Ä±klayan bir hata dÃ¶ndÃ¼rÃ¼r. Bu hata <code>Canceled</code> veya <code>DeadlineExceeded</code> olabilir.</p>
<p><code>Value</code> bir anahtar ile context iÃ§erisinde paylaÅŸtÄ±rÄ±lan bir deÄŸeri almamÄ±zÄ± saÄŸlar. Ana contextin verisi tÃ¼m hiyerarÅŸi iÃ§erisinde payÅŸaÅŸtÄ±rÄ±ldÄ±ÄŸÄ± iÃ§in; girilen anahtar tÃ¼m contextlerde aynÄ± deÄŸeri dÃ¶necektir. </p>
<div class="admonition warning">
<p class="admonition-title">UyarÄ±</p>
<p>Anahtar ve deÄŸerlerin tip kontrolÃ¼ olmadÄ±ÄŸÄ± iÃ§in, bu mekanizmayÄ± kullanarak gÃ¶revler ve hiyerarÅŸiler Ã¼zerinde veri paylaÅŸÄ±mÄ± yapmak <strong>kÃ¶tÃ¼ bir fikirdir</strong>.</p>
</div>
<p>Context paketi bu arayÃ¼zÃ¼ farklÄ± amaÃ§lar iÃ§in oluÅŸturan fonksiyonlar sunar.</p>
<ul>
<li>
<p><code>context.Background()</code> En temel contexti dÃ¶ndÃ¼rÃ¼r. DÃ¶nen context hiÃ§ bir iptal mekanizmas iÃ§ermez. TÃ¼m diÄŸer contextler Background contexi kullanÄ±larak oluÅŸturulur.</p>
</li>
<li>
<p><code>context.TODO()</code> temelde <code>context.Background()</code> ile aynÄ±dÄ±r. HenÃ¼z hangi tÃ¼r contexti kullanacaÄŸÄ±mÄ±zdan emin olmadÄ±ÄŸÄ±mÄ±z yerlerde, yer tutmasÄ± iÃ§in bu contexti kullanÄ±rÄ±z.</p>
</li>
</ul>
<p>Paket aynÄ± zamanda bu contextleri sarmalayÄ±p; iptal mekanizmasÄ± ekleyen fonksiyonlar barÄ±ndÄ±rÄ±r.</p>
<p>Bu fonksiyonlarÄ±n tamamÄ± ilk parametre olarak ana contexti alÄ±r. DÃ¶nÃ¼ÅŸ deÄŸeri olarak yeni bir context ve bir fonksiyon dÃ¶ndÃ¼rÃ¼r. </p>
<p>OluÅŸan contextin kriteri saÄŸlandÄ±ÄŸÄ±nda veya bize verdiÄŸi fonksiyonu Ã§aÄŸÄ±rdÄ±ÄŸÄ±mÄ±zda, contextin <code>Done()</code> kanalÄ±na bir sinyal gÃ¶nderilir. </p>
<ul>
<li><code>context.WithCancel(parent)</code> contexti uygulamanÄ±n bir anÄ±nda kendimiz durdurmak istediÄŸimizde kullanÄ±labilir. Bu fonksiyondan dÃ¶nen contextin ayrÄ±ca Ã§alÄ±ÅŸan bir iptal olma veya zaman aÅŸÄ±mÄ± durumu yoktur.</li>
</ul>
<p>AÅŸaÄŸÄ±daki Ã¶rnekte oluÅŸturduÄŸumuz Background contextini <code>context.WithCancel</code> ile sarmaladÄ±k.</p>
<p>ArdÄ±ndan bu contexti parametre alan 2 adet <code>SendRequest</code> gÃ¶revi ve 1 saniye sonra <code>cancel</code>
fonksiyonunu Ã§aÄŸÄ±ran bir gÃ¶rev oluÅŸturduk.</p>
<p>Dikkat edeceÄŸiniz Ã¼zere, tÃ¼m gÃ¶revler ilk parametre olarak aldÄ±ÄŸÄ± ve birbiriyle paylaÅŸtÄ±ÄŸÄ± contextin <code>&lt;- ctx.Done()</code> kanalÄ±nÄ± bekliyor.</p>
<p><code>cancel</code> fonksiyonu tetiklendiÄŸinde <code>ctx.Done()</code> kanalÄ±na sinyal gÃ¶ndererek tÃ¼m gÃ¶revlere contextin bittiÄŸini bildirecek.</p>
<p><img alt="cancel" src="../../assets/img/cancel.gif" /></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// SearchDB 2 saniye sonra normal bir ÅŸekilde sonlanÄ±r</span>
<span class="kd">func</span> <span class="nx">SearchDB</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">){</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Searching Database&quot;</span><span class="p">)</span>
    <span class="k">select</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Done</span><span class="p">():</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Search Cancelled&quot;</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">time</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">):</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Search Finished&quot;</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>
<span class="c1">// SendRequest 2 saniye sonra normal bir ÅŸekilde sonlanÄ±r</span>
<span class="kd">func</span> <span class="nx">SendRequest</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">){</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Processing Request&quot;</span><span class="p">)</span>

    <span class="k">go</span> <span class="nx">SearchDB</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">SearchDB</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span>

    <span class="k">select</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Done</span><span class="p">():</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Request Cancelled&quot;</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">time</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">):</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Request Finished&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">ctx</span> <span class="o">:=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">()</span>
    <span class="nx">cancellingCtx</span><span class="p">,</span> <span class="nx">cancel</span> <span class="o">:=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">WithCancel</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span>

    <span class="k">go</span> <span class="nx">SendRequest</span><span class="p">(</span><span class="nx">cancellingCtx</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">SendRequest</span><span class="p">(</span><span class="nx">cancellingCtx</span><span class="p">)</span>

    <span class="c1">// TÃ¼m requestleri ve database aramalarÄ±nÄ± 1 saniye sonra iptal edeceÄŸiz.</span>
    <span class="k">go</span> <span class="nx">time</span><span class="p">.</span><span class="nx">AfterFunc</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span> <span class="nx">cancel</span><span class="p">)</span>

    <span class="k">select</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">cancellingCtx</span><span class="p">.</span><span class="nx">Done</span><span class="p">():</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Cancelled by Context&quot;</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">time</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">3</span><span class="p">):</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Finished normally&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Context iptal edildikten sonra goroutinelerin ekrana </span>
    <span class="c1">// bir ÅŸeyler yazabilmesi iÃ§in biraz bekliyoruz.</span>
    <span class="o">&lt;-</span> <span class="nx">time</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<ul>
<li><code>context.WithTimeout(parent, duration)</code> contextin belirli bir sÃ¼re iÃ§inde tamamlanmasÄ±nÄ± istediÄŸimiz durumlarda kullanÄ±labilir. </li>
</ul>
<p>HazÄ±rda elimizde olan contextlere yeni zaman sÄ±nÄ±rlarÄ± ekleyebiliriz. Bu Ã¶rnek iÃ§in;
<code>SendRequest</code> fonksiyonuna timeout ekleyerek veritabanÄ±ndan 2 saniye iÃ§erisinde veri gelmezse gÃ¶revi iptal edebiliriz.</p>
<p><img alt="timeout" src="../../assets/img/timeout.gif" /></p>
<div class="codehilite"><pre><span></span><code><span class="c1">// SendRequest 5 saniye sonra normal bir ÅŸekilde biter</span>
<span class="c1">// VeritabanÄ± iÅŸini 2 saniye iÃ§erisinde tamamlanmazsa iptal eder</span>
<span class="kd">func</span> <span class="nx">SendRequest</span><span class="p">(</span><span class="nx">ctx</span> <span class="nx">context</span><span class="p">.</span><span class="nx">Context</span><span class="p">){</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Processing Request&quot;</span><span class="p">)</span>

    <span class="c1">// Bu context tÃ¼m veritabanÄ± iÅŸlemleri 2 saniye iÃ§erisinde </span>
    <span class="c1">// tamamlanmazsa iptal edecek</span>
    <span class="nx">dbCtx</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">WithTimeout</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">go</span> <span class="nx">SearchDB</span><span class="p">(</span><span class="nx">dbCtx</span><span class="p">)</span>
    <span class="k">go</span> <span class="nx">SearchDB</span><span class="p">(</span><span class="nx">dbCtx</span><span class="p">)</span>

    <span class="k">select</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">Done</span><span class="p">():</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Request Cancelled&quot;</span><span class="p">)</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">dbCtx</span><span class="p">.</span><span class="nx">Done</span><span class="p">():</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Search Timeout -&quot;</span><span class="p">,</span> <span class="nx">dbCtx</span><span class="p">.</span><span class="nx">Err</span><span class="p">())</span>  <span class="c1">// Search Timeout - context deadline exceeded</span>
    <span class="k">case</span> <span class="o">&lt;-</span> <span class="nx">time</span><span class="p">.</span><span class="nx">After</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">5</span><span class="p">):</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Request Finished&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


<ul>
<li><code>context.WithDeadline(parent, time)</code> contextin belli bir saatte tamamlanmasÄ±nÄ± istediÄŸimiz durumlarda kullanÄ±labilir.</li>
</ul>
<h2 id="ornek-uygulama">Ã–rnek Uygulama<a class="headerlink" href="#ornek-uygulama" title="Permanent link">&para;</a></h2>
<p>Bir gurup iÅŸÃ§i demir ve kÃ¶mÃ¼r barÄ±ndÄ±ran maden yataklarÄ±nda
maden arayÄ±p, kazÄ±p bu madenleri iÅŸlemektedir. </p>
<p>AÅŸaÄŸÄ±daki uygulamada go dilinin saÄŸladÄ±ÄŸÄ± concurrency araÃ§larÄ± ile iÅŸÃ§ilerin eÅŸ zamanlÄ± olarak nasÄ±l Ã§alÄ±ÅŸtÄ±rÄ±labileceÄŸini gÃ¶rebiliriz. </p>
<p><img alt="Miners" src="../../assets/img/miners.png" /></p>
<div class="codehilite"><pre><span></span><code><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;strconv&quot;</span>
    <span class="s">&quot;sync&quot;</span>
    <span class="s">&quot;time&quot;</span>
<span class="p">)</span>

<span class="c1">// Vein madenleri barÄ±ndÄ±rÄ±r</span>
<span class="kd">type</span> <span class="nx">Vein</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Ores</span> <span class="p">[]</span><span class="kt">string</span>
<span class="p">}</span>

<span class="c1">// Reveal bir sonraki madeni aÃ§Ä±ÄŸa Ã§Ä±karÄ±r</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">vein</span> <span class="o">*</span><span class="nx">Vein</span><span class="p">)</span> <span class="nx">Reveal</span><span class="p">()</span> <span class="p">(</span><span class="nx">ore</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">vein</span><span class="p">.</span><span class="nx">Ores</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">ore</span> <span class="p">=</span> <span class="nx">vein</span><span class="p">.</span><span class="nx">Ores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nx">vein</span><span class="p">.</span><span class="nx">Ores</span> <span class="p">=</span> <span class="nx">vein</span><span class="p">.</span><span class="nx">Ores</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="nx">ore</span>
<span class="p">}</span>

<span class="c1">// Worker madenleri bulur, kazar ve iÅŸler</span>
<span class="kd">type</span> <span class="nx">Worker</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">name</span> <span class="kt">string</span>
<span class="p">}</span>

<span class="c1">// Find maden yataÄŸÄ±nda arama yapar ve bulduÄŸu madeni kazÄ±cÄ±lara gÃ¶nderir</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">w</span> <span class="o">*</span><span class="nx">Worker</span><span class="p">)</span> <span class="nx">Find</span><span class="p">(</span><span class="nx">vein</span> <span class="o">*</span><span class="nx">Vein</span><span class="p">,</span> <span class="nx">ch</span> <span class="kd">chan</span><span class="o">&lt;-</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ore</span> <span class="o">:=</span> <span class="nx">vein</span><span class="p">.</span><span class="nx">Reveal</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">ore</span> <span class="o">!=</span> <span class="s">&quot;&quot;</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s">&quot;found&quot;</span><span class="p">,</span> <span class="nx">ore</span><span class="p">)</span>
        <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

        <span class="nx">ch</span> <span class="o">&lt;-</span> <span class="nx">ore</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="c1">// Mine madeni Ã§Ä±kartÄ±r ve iÅŸleme kanalÄ±na gÃ¶nderir</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">w</span> <span class="o">*</span><span class="nx">Worker</span><span class="p">)</span> <span class="nx">Mine</span><span class="p">(</span><span class="nx">finder</span> <span class="o">&lt;-</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">smelter</span> <span class="kd">chan</span><span class="o">&lt;-</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nx">ore</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">finder</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s">&quot;mining&quot;</span><span class="p">,</span> <span class="nx">ore</span><span class="p">)</span>
        <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nx">smelter</span> <span class="o">&lt;-</span> <span class="nx">ore</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Smelt madenleri eritir veya iÅŸler</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">w</span> <span class="o">*</span><span class="nx">Worker</span><span class="p">)</span> <span class="nx">Smelt</span><span class="p">(</span><span class="nx">coal_miner</span><span class="p">,</span> <span class="nx">iron_miner</span> <span class="o">&lt;-</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">wg</span> <span class="o">*</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">{</span>
        <span class="k">select</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">coal_ore</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">coal_miner</span><span class="p">:</span>
            <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s">&quot;processed&quot;</span><span class="p">,</span> <span class="nx">coal_ore</span><span class="p">)</span>
        <span class="k">case</span> <span class="nx">iron_ore</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">iron_miner</span><span class="p">:</span>
            <span class="nx">time</span><span class="p">.</span><span class="nx">Sleep</span><span class="p">(</span><span class="nx">time</span><span class="p">.</span><span class="nx">Second</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="s">&quot;smelted&quot;</span><span class="p">,</span> <span class="nx">iron_ore</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nx">wg</span><span class="p">.</span><span class="nx">Done</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">wg</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">sync</span><span class="p">.</span><span class="nx">WaitGroup</span><span class="p">{}</span>

    <span class="c1">// 100 demir barÄ±ndÄ±ran bir maden oluÅŸtur</span>
    <span class="nx">n_iron_ores</span> <span class="o">:=</span> <span class="mi">100</span>
    <span class="nx">iron_vein</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Vein</span><span class="p">{</span><span class="nb">make</span><span class="p">([]</span><span class="kt">string</span><span class="p">,</span> <span class="nx">n_iron_ores</span><span class="p">)}</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">iron_vein</span><span class="p">.</span><span class="nx">Ores</span> <span class="p">{</span>
        <span class="nx">iron_vein</span><span class="p">.</span><span class="nx">Ores</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">=</span> <span class="s">&quot;iron-ore-&quot;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Itoa</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// 50 kÃ¶mÃ¼r barÄ±ndÄ±ran bir maden oluÅŸtur</span>
    <span class="nx">n_coal_ores</span> <span class="o">:=</span> <span class="mi">50</span>
    <span class="nx">coal_vein</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Vein</span><span class="p">{</span><span class="nb">make</span><span class="p">([]</span><span class="kt">string</span><span class="p">,</span> <span class="nx">n_coal_ores</span><span class="p">)}</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">coal_vein</span><span class="p">.</span><span class="nx">Ores</span> <span class="p">{</span>
        <span class="nx">coal_vein</span><span class="p">.</span><span class="nx">Ores</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">=</span> <span class="s">&quot;coal-ore-&quot;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Itoa</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Ä°ÅŸÃ§iler arasÄ±nda maden iletim kanallarÄ± oluÅŸtur</span>
    <span class="nx">finder_to_miner</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>
    <span class="nx">coal_miner_to_smelter</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>
    <span class="nx">iron_miner_to_smelter</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>

    <span class="c1">// Maden arama iÅŸÃ§ileri oluÅŸtur</span>
    <span class="nx">n_finders</span> <span class="o">:=</span> <span class="mi">6</span>
    <span class="nx">finders</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="o">*</span><span class="nx">Worker</span><span class="p">,</span> <span class="nx">n_finders</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">finders</span> <span class="p">{</span>
        <span class="nx">finders</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">Worker</span><span class="p">{</span>
            <span class="nx">name</span><span class="p">:</span> <span class="s">&quot;finder-&quot;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Itoa</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Maden kazÄ±cÄ±larÄ± oluÅŸtur</span>
    <span class="nx">n_miners</span> <span class="o">:=</span> <span class="mi">50</span>
    <span class="nx">miners</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="o">*</span><span class="nx">Worker</span><span class="p">,</span> <span class="nx">n_miners</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">miners</span> <span class="p">{</span>
        <span class="nx">miners</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">Worker</span><span class="p">{</span>
            <span class="nx">name</span><span class="p">:</span> <span class="s">&quot;miner-&quot;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Itoa</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Maden iÅŸleyicileri oluÅŸtur</span>
    <span class="nx">n_smelters</span> <span class="o">:=</span> <span class="mi">10</span>
    <span class="nx">smelters</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="o">*</span><span class="nx">Worker</span><span class="p">,</span> <span class="nx">n_smelters</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">smelters</span> <span class="p">{</span>
        <span class="nx">smelters</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">Worker</span><span class="p">{</span>
            <span class="nx">name</span><span class="p">:</span> <span class="s">&quot;smelter-&quot;</span> <span class="o">+</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Itoa</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Maden aramacÄ±larÄ±n yarÄ±sÄ±nÄ± demir, diÄŸer yarÄ±sÄ±nÄ± kÃ¶mÃ¼r madenine gÃ¶nder</span>
    <span class="k">for</span> <span class="nx">i</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="p">&lt;</span> <span class="nx">n_iron_ores</span><span class="o">+</span><span class="nx">n_coal_ores</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span> <span class="p">{</span>

        <span class="nx">wg</span><span class="p">.</span><span class="nx">Add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="nx">finder_idx</span> <span class="o">:=</span> <span class="nx">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="nx">finders</span><span class="p">)</span>

        <span class="k">go</span> <span class="nx">finders</span><span class="p">[</span><span class="nx">finder_idx</span><span class="p">].</span><span class="nx">Find</span><span class="p">(</span><span class="nx">coal_vein</span><span class="p">,</span> <span class="nx">finder_to_miner</span><span class="p">)</span>
        <span class="k">go</span> <span class="nx">finders</span><span class="p">[</span><span class="nx">finder_idx</span><span class="p">].</span><span class="nx">Find</span><span class="p">(</span><span class="nx">iron_vein</span><span class="p">,</span> <span class="nx">finder_to_miner</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// KazÄ±cÄ±larÄ±n yarÄ±sÄ±nÄ± demir, diÄŸer yarÄ±sÄ±nÄ± kÃ¶mÃ¼r madeninde Ã§alÄ±ÅŸtÄ±r </span>
    <span class="k">for</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">miner</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">miners</span> <span class="p">{</span>

        <span class="k">if</span> <span class="nx">i</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span>
            <span class="k">go</span> <span class="nx">miner</span><span class="p">.</span><span class="nx">Mine</span><span class="p">(</span><span class="nx">finder_to_miner</span><span class="p">,</span> <span class="nx">iron_miner_to_smelter</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">go</span> <span class="nx">miner</span><span class="p">.</span><span class="nx">Mine</span><span class="p">(</span><span class="nx">finder_to_miner</span><span class="p">,</span> <span class="nx">coal_miner_to_smelter</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="p">}</span>

    <span class="c1">// Maden iÅŸleyen iÅŸÃ§ileri Ã§alÄ±ÅŸtÄ±r</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">smelter</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">smelters</span> <span class="p">{</span>
        <span class="k">go</span> <span class="nx">smelter</span><span class="p">.</span><span class="nx">Smelt</span><span class="p">(</span><span class="nx">coal_miner_to_smelter</span><span class="p">,</span> <span class="nx">iron_miner_to_smelter</span><span class="p">,</span> <span class="nx">wg</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// BÃ¼tÃ¼n madenlerin bulunmasÄ±nÄ±, kazÄ±lmasÄ±nÄ± ve iÅŸlenmesini bekle</span>
    <span class="nx">wg</span><span class="p">.</span><span class="nx">Wait</span><span class="p">()</span>

<span class="p">}</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/mgurdal" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
      
      
      <a href="https://twitter.com/mgurdal_" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
      <a href="https://linkedin.com/in/mgurdal" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="../../assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>